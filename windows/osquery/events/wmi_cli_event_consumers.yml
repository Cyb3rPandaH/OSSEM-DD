title: Wmi_cli_event_consumers Table
description: WMI CommandLineEventConsumer, which can be used for persistence on Windows.
  See https://www.blackhat.com/docs/us-15/materials/us-15-Graeber-Abusing-Windows-Management-Instrumentation-WMI-To-Build-A-Persistent%20Asynchronous-And-Fileless-Backdoor-wp.pdf
  for more details.
platform: windows
log_source: osquery
event_code: wmi_cli_event_consumers
event_version: 4.4.2
event_fields:
- standard_name: TBD
  standard_type: TBD
  name: name
  type: TEXT
  description: Unique name of a consumer.
  sample_value: TBD
- standard_name: TBD
  standard_type: TBD
  name: command_line_template
  type: TEXT
  description: Standard string template that specifies the process to be started.
    This property can be NULL, and the ExecutablePath property is used as the command
    line.
  sample_value: TBD
- standard_name: TBD
  standard_type: TBD
  name: executable_path
  type: TEXT
  description: Module to execute. The string can specify the full path and file name
    of the module to execute, or it can specify a partial name. If a partial name
    is specified, the current drive and current directory are assumed.
  sample_value: TBD
- standard_name: TBD
  standard_type: TBD
  name: class
  type: TEXT
  description: The name of the class.
  sample_value: TBD
- standard_name: TBD
  standard_type: TBD
  name: relative_path
  type: TEXT
  description: Relative path to the class or instance.
  sample_value: TBD
references:
- text: OSQuery table documentation
  link: https://osquery.io/schema/current#wmi_cli_event_consumers
tags: []
