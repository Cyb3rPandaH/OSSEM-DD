name: 'Event ID 18: PipeEvent (Pipe Connected)'
description: This event logs when a **named pipe connection** is made between a client and a server.
platform: windows
log_source: sysmon
event_id: '18'
event_version: '4.32'
event_fields:
- standard_name: EventType
  standard_type: TBD
  name: EventType
  type: string
  description: TBD
  sample_value: '[CreatePipe]{.underline}'
- standard_name: Tag
  standard_type: TBD
  name: RuleName
  type: string
  description: custom tag mapped to event. i.e ATT&CK technique ID
  sample_value: T1114
- standard_name: EventCreationTime
  standard_type: TBD
  name: UtcTime
  type: date
  description: Time in UTC when event was created
  sample_value: 4/11/18 6:28
- standard_name: ProcessGuid
  standard_type: TBD
  name: ProcessGuid
  type: string
  description: Process Guid of the process that connected the pipe
  sample_value: '{A98268C1-959E-5ACD-0000-0010236E0300}'
- standard_name: ProcessId
  standard_type: TBD
  name: ProcessId
  type: integer
  description: Process ID used by the os to identify the process that connected the pipe
  sample_value: '1896'
- standard_name: PipeName
  standard_type: TBD
  name: PipeName
  type: string
  description: Name of the pipe connecged
  sample_value: \srvsvc
- standard_name: ProcessFilePath
  standard_type: TBD
  name: Image
  type: string
  description: File path of the process that connected the pipe
  sample_value: C:\WINDOWS\system32\wbem\wmiprvse.exe
references:
- text: Sysmon Source
  link: https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-18-pipeevent-pipe-connected
- text: TrustedSec Sysmon Community Guide
  link: https://github.com/trustedsec/SysmonCommunityGuide/blob/master/named-pipes.md
tags: []
event_sample:
- format: xml
  sample: |-
    <EventData>
    <Data Name="RuleName">-</Data>
    <Data Name="EventType">ConnectPipe</Data>
    <Data Name="UtcTime">2022-06-29 19:02:29.022</Data>
    <Data Name="ProcessGuid">{01e2a015-0003-62bc-1b00-000000000500}</Data>
    <Data Name="ProcessId">676</Data>
    <Data Name="PipeName">\VBoxTrayIPC-pedro</Data>
    <Data Name="Image">C:\Windows\System32\VBoxService.exe</Data>
    <Data Name="User">NT AUTHORITY\SYSTEM</Data>
    </EventData>
