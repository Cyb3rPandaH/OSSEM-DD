name: 'Event ID 2: A process changed a file creation time'
description: The change **file creation time** event is registered when a file creation time is explicitly modified by a process. This event helps tracking the real creation time of a file. Attackers may change the file creation time of a backdoor to make it look like it was installed with the operating system. Note that many processes legitimately change the creation time of a file; it does not necessarily indicate malicious activity.
platform: windows
log_source: sysmon
event_id: '2'
event_version: '4.32'
event_fields:
- standard_name: tag
  standard_type: TBD
  name: RuleName
  type: string
  description: custom tag mapped to event. i.e ATT&CK technique ID
  sample_value: T1114
- standard_name: event_creation_time
  standard_type: TBD
  name: UtcTime
  type: date
  description: Time in UTC when event was created
  sample_value: 4/11/18 5:04
- standard_name: process_guid
  standard_type: TBD
  name: ProcessGuid
  type: string
  description: Process Guid of the process that changed the file creation time
  sample_value: '{A98268C1-975A-5ACD-0000-0010DB073A00}'
- standard_name: process_id
  standard_type: TBD
  name: ProcessId
  type: integer
  description: Process ID used by the os to identify the process changing the file creation time
  sample_value: '1252'
- standard_name: process_file_path
  standard_type: TBD
  name: Image
  type: string
  description: File path of the process that changed the file creation time
  sample_value: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
- standard_name: file_name
  standard_type: TBD
  name: TargetFilename
  type: string
  description: full path name of the file
  sample_value: C:\Users\wardog\AppData\Roaming\Microsoft\Windows\Recent\CustomDestinations\7G23PHTPHSQ3S2RVKKPS.temp
- standard_name: file_creation_time
  standard_type: TBD
  name: CreationUtcTime
  type: date
  description: new creation time of the file
  sample_value: 11/13/17 16:57
- standard_name: file_previous_creation_time
  standard_type: TBD
  name: PreviousCreationUtcTime
  type: date
  description: previous creation time of the file
  sample_value: 4/11/18 5:04
references:
- text: Sysmon Source
  link: https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon#event-id-2-a-process-changed-a-file-creation-time
- text: TrustedSec Sysmon Community Guide
  link: https://github.com/trustedsec/SysmonCommunityGuide/blob/master/file-create-time-change.md
tags: []
event_sample:
- format: xml
  sample: |-
    <EventData>
    <Data Name="RuleName">-</Data>
    <Data Name="UtcTime">2022-06-29 18:37:12.607</Data>
    <Data Name="ProcessGuid">{01e2a015-752e-62bc-2e03-000000000500}</Data>
    <Data Name="ProcessId">1836</Data>
    <Data Name="Image">C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe</Data>
    <Data Name="TargetFilename">C:\Users\pedro\AppData\Local\Microsoft\Edge\User Data\6403de3a-d41b-499a-85f6-6ca715a2c53e.tmp</Data>
    <Data Name="CreationUtcTime">2022-06-28 16:50:17.602</Data>
    <Data Name="PreviousCreationUtcTime">2022-06-29 18:37:12.607</Data>
    <Data Name="User">DESKTOP-CQF82L6\pedro</Data>
    </EventData>